# bluecms渗透测试【白维扬】

------

[TOC]

------

## 1.信息收集

ping www.baiweiyang.xyz

【一个我之前买的域名，备案到了一个我们的云服务器】

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 14.47.51.png" alt="截屏2020-11-30 14.47.51" style="zoom:50%;" />

我们得知服务器的ip为47.110.130.25，同时ttl>100。可以估计服务器大概率是windows系统。

又ping了一下我的本机

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 14.49.51.png" alt="截屏2020-11-30 14.49.51" style="zoom:50%;" />

Integrity【一个mac上的扫描工具】

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 14.39.41.png" alt="截屏2020-11-30 14.39.41" style="zoom:50%;" />

拿到了网站目录。

收集站长信息【这里我收集的是我的域名】

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 14.57.31.png" alt="截屏2020-11-30 14.57.31" style="zoom:50%;" />

我们可以得知服务器域名是个人的，叫白维扬，备案号是冀，人应该在河北，域名买的阿里云的。

使用Zenmap扫描端口【这里用的是我本机ip

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 15.02.14.png" alt="截屏2020-11-30 15.02.14" style="zoom:50%;" />

我们可以看出开放了很多端口，再具体测试一下几个具体常用端口。

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 15.15.07.png" alt="截屏2020-11-30 15.15.07" style="zoom:50%;" />

可以看出来，这些端口运行着服务。

又扫描了一下1-65535所有端口

![截屏2020-11-30 15.47.29](%E6%88%AA%E5%B1%8F2020-11-30%2015.47.29.png)

使用Zenmap扫描服务器操作系统

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 15.04.31.png" alt="截屏2020-11-30 15.04.31" style="zoom:50%;" />

可以得到服务器是苹果系统，macos 10.14.x

使用Zenmap进行全系统扫描

<img src="/Users/baiweiyang/Desktop/hack/截屏2020-11-30 15.05.14.png" alt="截屏2020-11-30 15.05.14" style="zoom:50%;" />

服务器开放了631，8888两个端口，用的Apache，操作系统是苹果。

------

## 2.漏洞扫描

打开burp suite，设置代理，打开访问http://bluecms:8888/uploads/，进行scan【扫描】。

得到结果如图

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2016.12.39.png" alt="截屏2020-11-30 16.12.39" style="zoom:50%;" />

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2016.11.27.png" alt="截屏2020-11-30 16.11.27" style="zoom:50%;" />

我们可以看到首页扫描出两个漏洞，分别是，密码明文保存和密码的autocomplete属性可用。【大概翻译】

再对/admin进行一次漏洞扫描，结果如图

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2016.33.22.png" alt="截屏2020-11-30 16.33.22" style="zoom:50%;" />

一样的两个漏洞

------

## 3.爬取网站

对bluecms:8888进行爬取，过程中需要填写的表单，user_name  = white, password = white。用户名和账号已经提前注册了才进行的扫描。

![截屏2020-11-30 16.41.31](%E6%88%AA%E5%B1%8F2020-11-30%2016.41.31.png)

可以看到我们扫描出了一部分目录结构，而且包括sql语句。

------

## 4.自动化攻击

### 4.1 用intruder进行密码爆破

首先从github找一个密码字典的仓库，下载下来作为我们的密码字典，

前端登陆，用户名是admin【根据社会工程学，这个用户名大概率是有对应用户的】，捕获请求，修改密码，load 字典【这里选择了几个比较小的字典，总量在将近3w，】，attack攻击，结果如图

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2017.11.12.png" alt="截屏2020-11-30 17.11.12" style="zoom:50%;" />

手动登陆一下，发现admin账号不能前端登陆，所以返回报文长度一样，再注册一个，name = white,pwd= white。

模拟请求，字典里手动加入white。

配置如图

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2017.14.40.png" alt="截屏2020-11-30 17.14.40" style="zoom:50%;" />

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2017.14.43.png" alt="截屏2020-11-30 17.14.43" style="zoom:50%;" />

攻击结果如图：

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2017.19.32.png" alt="截屏2020-11-30 17.19.32" style="zoom:50%;" />

明显报文长短不一样的是正确密码，实际也确实如此

### 4.2 用intruder进行sql注入

同样是前端登陆，用户名white，捕获请求，修改密码，load 字典【这里的字典是我之前收集的一些sql注入语句，137条】，配置如图。

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2017.21.33.png" alt="截屏2020-11-30 17.21.33" style="zoom:50%;" />

attack攻击，结果如图

![截屏2020-11-30 17.26.51](%E6%88%AA%E5%B1%8F2020-11-30%2017.26.51.png)

所有报文长短一样，所以应该是没有sql注入漏洞。

再对后台管理系统进行sql注入。

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2019.57.52.png" alt="截屏2020-11-30 19.57.52" style="zoom:50%;" />

返回的所有报文也都是一样大小，所以网站应该是不存在sql注入漏洞的。

然而当我想再次以正常的方式登入数据库时，手动正确的账号密码，返回的网页却是

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2020.06.29.png" alt="截屏2020-11-30 20.06.29" style="zoom:50%;" />

可以说后台登陆已经瘫痪了。无奈重新初始化网站。

------

## 5.手工测试

### 1.测试sql注入

拿前台后台登陆页面测试，手动输入了一些常见数据库的sql注入语句，都没有成功登陆，所以不存在sql注入。

### 2.对前台页面进行xss漏洞测试

在个人资料页面填写xss攻击语句，保存，刷新也没拿，没有出现alert，所以前端可能不存在存储型xss漏洞。

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2019.49.45.png" alt="截屏2020-11-30 19.49.45" style="zoom:50%;" />

### 3.对后台管理系统进行xss漏洞测试

后台登陆后导航管理这里，添加xss脚本

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2020.24.44.png" alt="截屏2020-11-30 20.24.44" style="zoom:50%;" />

提交后，再次点击左侧的导航管理，alert出现，说明后台存在存储型xss漏洞。

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2020.26.13.png" alt="截屏2020-11-30 20.26.13" style="zoom:50%;" />

在后台站点设置里，把联系方式换成xss脚本，保存，然后再在打开前台页面，发现执行了xss脚本。

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2020.29.49.png" alt="截屏2020-11-30 20.29.49" style="zoom:50%;" />

<img src="%E6%88%AA%E5%B1%8F2020-11-30%2020.31.11.png" alt="截屏2020-11-30 20.31.11" style="zoom:50%;" />

更加确定存在存储型xss漏洞。